<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>AR Copo com Música</title>

  <!-- A-Frame + AR.js -->
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.3.2/aframe/build/aframe-ar.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }

    #musicButton {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 14px 22px;
      font-size: 16px;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 40px;
      cursor: pointer;
      z-index: 999;
      display: flex;
      align-items: center;
      gap: 10px;
      opacity: 0.9;
    }

    #musicButton:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .icon {
      font-size: 18px;
    }
  </style>
</head>

<body>

<!-- Botão -->
<button id="musicButton" disabled>
  <span class="icon">⏳</span>
  Aguarde
</button>

<a-scene
  embedded
  vr-mode-ui="enabled: false"
  arjs="trackingMethod: best; sourceType: webcam;"
>

  <!-- Marcador -->
  <a-marker preset="custom" url="seu-marcador.patt">

    <!-- Imagem em AR -->
    <a-image
      src="modelo.png"
      position="0 0 0"
      rotation="-90 0 0"
      scale="1 1 1">
    </a-image>

    <!-- Áudio -->
    <a-sound
      id="musica"
      src="musica.mp3"
      loop="true"
      volume="0"
      position="0 0 0">
    </a-sound>

  </a-marker>

  <a-entity camera></a-entity>
</a-scene>

<script>
  const botao = document.getElementById("musicButton");
  const icone = botao.querySelector(".icon");
  const musica = document.querySelector("#musica");

  let tocando = false;
  let volumeAtual = 0;

  // Quando o áudio carregar
  musica.addEventListener("loaded", () => {
    botao.disabled = false;
    icone.textContent = "▶️";
    botao.lastChild.textContent = " Tocar música";
  });

  // Fade in suave
  function fadeInVolume() {
    volumeAtual = 0;
    musica.setAttribute("volume", volumeAtual);

    const intervalo = setInterval(() => {
      volumeAtual += 0.05;
      musica.setAttribute("volume", volumeAtual);

      if (volumeAtual >= 1) {
        clearInterval(intervalo);
      }
    }, 120);
  }

  botao.addEventListener("click", () => {
    if (!tocando) {
      musica.components.sound.playSound();
      fadeInVolume();
      icone.textContent = "⏸";
      botao.lastChild.textContent = " Pausar";
      tocando = true;
    } else {
      musica.components.sound.pauseSound();
      icone.textContent = "▶️";
      botao.lastChild.textContent = " Tocar música";
      tocando = false;
    }
  });
</script>

</body>
</html>
